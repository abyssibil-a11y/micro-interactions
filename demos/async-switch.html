<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Async Switch</title>
    <link rel="stylesheet" href="../async-switch/async-switch.css" />
    <script type="module">
        import AsyncSwitch from '../async-switch/async-switch.js';
        import Toast from '../utils/toast.js';
        import { sleep, maybeFail } from '../utils/asyncHelpers.js';

        const showToast = Toast({ duration: 2500 });

        async function fakeSave(nextState, el) {
            await sleep(800);
            maybeFail(0.25);
        }

        AsyncSwitch('.switch', {
            save: fakeSave,
            toast: showToast,
            onChange: (state, el) => {
                console.log(el.dataset.name, "is now", state ? "ON" : "OFF");
            },
        });

    </script>

</head>

<body>
    <div class="switch-wrapper">

        <div class="switch" data-name="email-notifs">
            <div class="switch-thumb"></div>
        </div>

        <span class="switch-label">Email notifications</span>
    </div></br>

    <div class="switch-wrapper">

        <div class="switch" data-name="sms-notifs">
            <div class="switch-thumb"></div>
        </div>

        <span class="switch-label">SMS notifications</span>
    </div>

</body>

</html>